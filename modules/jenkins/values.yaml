controller:
  # Jenkins Controller Konfiguration
  image:
    registry: "docker.io"
    repository: "jenkins/jenkins"
    tag: "lts"

  # Service Configuration
  serviceType: LoadBalancer

  # Resource Limits
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "2000m"
      memory: "4Gi"

  # JVM Options
  javaOpts: "-Xms512m -Xmx2048m"

  # Jenkins Configuration as Code (JCasC)
  JCasC:
    defaultConfig: true
    configScripts:
      welcome-message: |
        jenkins:
          systemMessage: "Jenkins mit Kaniko + Git für CI/CD Pipeline"

  # Installiere notwendige Plugins
  installPlugins:
    - kubernetes:4029.v5712230ccb_f8
    - workflow-aggregator:596.v8c21c963d92d
    - git:5.2.0
    - configuration-as-code:1670.v564dc8b_982d0
    - credentials-binding:631.v861a_8d9fd67e
    - pipeline-stage-view:2.33
    - github:1.37.3.1
    - workflow-job:1289.vd1c337fd5354
    - pipeline-model-definition:2.2141.v5402e818a_779
    - blueocean:1.27.9
    - amazon-ecr:1.78.v4b_18b_563d6d6

  # Admin User
  admin:
    username: "admin"
  # Password wird automatisch generiert

  # Service Account mit Permissions
  serviceAccount:
    create: true
    name: jenkins
    annotations:
      # Optional: IRSA (IAM Roles for Service Accounts) für ECR
      # eks.amazonaws.com/role-arn: "arn:aws:iam::ACCOUNT_ID:role/jenkins-ecr-role"

# Agent (Pod Templates) Konfiguration
agent:
  enabled: true

  # Namespace für Agents
  namespace: "jenkins"

  # Default Pod Template
  podName: "jenkins-agent"

  # Resource Limits für Standard Agent
  resources:
    requests:
      cpu: "500m"
      memory: "512Mi"
    limits:
      cpu: "1000m"
      memory: "1Gi"

  # Custom Pod Templates (Kaniko + Git)
  podTemplates:
    kaniko: |
      - name: kaniko
        label: kaniko
        serviceAccount: jenkins
        containers:
          - name: kaniko
            image: gcr.io/kaniko-project/executor:v1.19.0-debug
            imagePullPolicy: Always
            command:
              - /busybox/cat
            tty: true
            volumeMounts:
              - name: docker-config
                mountPath: /kaniko/.docker
              - name: workspace-volume
                mountPath: /workspace
            resources:
              requests:
                cpu: "500m"
                memory: "1Gi"
              limits:
                cpu: "2000m"
                memory: "2Gi"
          - name: git
            image: alpine/git:latest
            imagePullPolicy: Always
            command:
              - cat
            tty: true
            volumeMounts:
              - name: workspace-volume
                mountPath: /workspace
            resources:
              requests:
                cpu: "100m"
                memory: "128Mi"
              limits:
                cpu: "500m"
                memory: "512Mi"
        volumes:
          - name: docker-config
            secret:
              secretName: docker-config
          - name: workspace-volume
            emptyDir: {}

# Persistence für Jenkins Home
persistence:
  enabled: true
  storageClass: "gp2-csi"
  accessMode: "ReadWriteOnce"
  size: "20Gi"

# Service Account Permissions
rbac:
  create: true
  readSecrets: true
